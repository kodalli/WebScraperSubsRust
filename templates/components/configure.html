<div id="configure-modal"
    class="fixed top-0 left-0 w-full h-full bg-black bg-opacity-75 flex items-center justify-center z-50">

    <div class="relative bg-gray-900 p-6 rounded-lg shadow-lg border border-yellow-500 w-full max-w-md">
        <!-- Header -->
        <div class="flex items-center justify-between mb-6">
            <div>
                <h2 class="text-lg font-semibold text-white">{{ title }}</h2>
                <span class="text-xs text-gray-500">ID: {{ id }}</span>
            </div>
            <button hx-get="api/close" hx-swap="outerHTML swap:out" hx-target="#configure-modal"
                class="text-gray-400 hover:text-white text-2xl font-bold w-8 h-8 flex items-center justify-center">
                &times;
            </button>
        </div>

        <form hx-post="api/save_configuration" hx-swap="outerHTML swap:out" hx-target="#configure-modal" class="space-y-5">
            <input type="hidden" name="title" value="{{ title }}">
            <input type="hidden" name="id" value="{{ id }}">

            <!-- Alternate Title -->
            <div>
                <label for="alternate" class="block text-sm font-medium text-yellow-400 mb-1">
                    Search Title
                </label>
                <input type="text" name="alternate" id="alternate" value="{{ alternate }}"
                    class="w-full px-3 py-2 bg-gray-800 text-white text-sm rounded border border-gray-600 focus:border-yellow-500 focus:outline-none"
                    placeholder="Title used for searching" required />
                <p class="mt-1 text-xs text-gray-500">Used to match releases on RSS/Nyaa.si</p>
            </div>

            <!-- Source & Quality Row -->
            <div class="grid grid-cols-2 gap-4">
                <div>
                    <label for="source" class="block text-sm font-medium text-yellow-400 mb-1">Source</label>
                    <select name="source" id="source"
                        class="w-full px-3 py-2 bg-gray-800 text-white text-sm rounded border border-gray-600 focus:border-yellow-500 focus:outline-none">
                        <option value="subsplease" {% if source == "subsplease" %}selected{% endif %}>SubsPlease</option>
                        <option value="Erai-raws" {% if source == "Erai-raws" %}selected{% endif %}>Erai-raws</option>
                    </select>
                </div>
                <div>
                    <label for="quality" class="block text-sm font-medium text-yellow-400 mb-1">Quality</label>
                    <select name="quality" id="quality"
                        class="w-full px-3 py-2 bg-gray-800 text-white text-sm rounded border border-gray-600 focus:border-yellow-500 focus:outline-none">
                        <option value="480p" {% if quality == "480p" %}selected{% endif %}>480p</option>
                        <option value="720p" {% if quality == "720p" %}selected{% endif %}>720p</option>
                        <option value="1080p" {% if quality == "1080p" %}selected{% endif %}>1080p</option>
                        <option value="2160p" {% if quality == "2160p" %}selected{% endif %}>4K</option>
                    </select>
                </div>
            </div>

            <!-- Season & Last Episode Row -->
            <div class="grid grid-cols-2 gap-4">
                <div>
                    <label for="season" class="block text-sm font-medium text-yellow-400 mb-1">Season</label>
                    <select name="season" id="season"
                        class="w-full px-3 py-2 bg-gray-800 text-white text-sm rounded border border-gray-600 focus:border-yellow-500 focus:outline-none">
                        {% for i in 1..10 %}
                        <option value="{{ i }}" {% if season == i %}selected{% endif %}>Season {{ i }}</option>
                        {% endfor %}
                    </select>
                </div>
                <div>
                    <label for="last_downloaded_episode" class="block text-sm font-medium text-yellow-400 mb-1">Last Downloaded</label>
                    <input type="number" name="last_downloaded_episode" id="last_downloaded_episode"
                        value="{{ last_downloaded_episode }}" min="0"
                        class="w-full px-3 py-2 bg-gray-800 text-white text-sm rounded border border-gray-600 focus:border-yellow-500 focus:outline-none"
                        placeholder="Episode #" />
                </div>
            </div>

            <!-- Download Path -->
            <div>
                <label for="download_path" class="block text-sm font-medium text-yellow-400 mb-1">
                    Download Path
                    <span class="text-gray-500 font-normal">(optional)</span>
                </label>
                <input type="text" name="download_path" id="download_path"
                    value="{{ download_path.as_deref().unwrap_or("") }}"
                    class="w-full px-3 py-2 bg-gray-800 text-white text-sm rounded border border-gray-600 focus:border-yellow-500 focus:outline-none"
                    placeholder="/custom/download/path" />
            </div>

            <!-- Submit Button -->
            <button type="submit"
                class="w-full py-2.5 bg-yellow-500 text-black font-semibold rounded hover:bg-yellow-400 transition-colors">
                Save Configuration
            </button>
        </form>
    </div>
</div>
